<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Survey</title>
         <h:outputStylesheet library="css" name="styles.css"/>
        <script src="jquery-3.5.1.js" type="text/javascript"></script>
        <script type="text/javascript">
           function handleClick(){
               
           }           
        </script>
    </h:head>
    <h:body>
        <!--Header-->
        <h1 class="header">Form Builder ðŸ“ƒ</h1> <br/>
        <!--Survey Title-->
        
            <h:panelGroup layout="block" class="form-div" >
            <h:form id="form-id" prependId="true">
               
                <h:inputHidden id="hidden-section" value="#{sectionBean2.sectionIndex}"></h:inputHidden>
                <h:inputTextarea value="#{sectionBean2.name}" id="section1" required="true"
                             requiredMessage="Please fill this field"/>
                
                <h:commandButton class="button" value="Add TEXT" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='TEXT' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add TEXTAREA" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='TEXTAREA' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add SECRET" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='SECRET' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add CHECKONE" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='CHECKONE' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add LABEL" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='LABEL' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add COMBOBOX" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='COMBOBOX' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                
                <h:outputText id="section" class="header-section" value="Form" rendered="true" />
                
                <ui:repeat value="#{sectionBean2.sections}" var="section" id="ui-outer">
                    <ui:repeat value="#{section}" var="item" id="ui-inner">
                    <h:panelGroup class="item">
                        <h:outputText id="section" class="added-section" value="#{item.name}" rendered="#{item.type == 'SECTION'}">
                            <!--<f:ajax execute="@this.id" render="#{sectionBean2.clickedID}" event="click" listener="#{sectionBean2.selectSectionIndex}" />-->
                        </h:outputText>
                        <h:inputText class="added-item" value="#{item.name}" rendered="#{item.type == 'TEXT'}" />
                        <h:inputSecret class="added-item" value="#{item.name}" rendered="#{item.type == 'SECRET'}" />
                        <h:inputTextarea class="added-item" value="#{item.name}" rendered="#{item.type == 'TEXTAREA'}" />
                        <h:selectBooleanCheckbox class="added-item" value="#{item.name}" rendered="#{item.type == 'CHECKONE'}" />
                        <h:outputLabel class="added-item" value="#{item.name}" for="text1" rendered="#{item.type == 'LABEL'}" />
                        <h:selectOneMenu class="added-item" value = "#{item.name}" rendered="#{item.type == 'COMBOBOX'}">
                            <f:selectItem itemValue = "1" itemLabel = "Item 1" />
                            <f:selectItem itemValue = "2" itemLabel = "Item 2" />
                        </h:selectOneMenu>
                    </h:panelGroup>
                    </ui:repeat>    
                </ui:repeat>
                <h:panelGroup class="add-section">
                <h:inputTextarea value="#{sectionBean2.name}" id="section2" required="true"
                             requiredMessage="Please fill this field"/>
                
                <h:commandButton class="button" value="Add Section" action="#{sectionBean2.addSection()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='SECTION' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                </h:panelGroup>
                
            </h:form>
        </h:panelGroup>
         
        <script type="text/javascript">
           
            $(document.getElementById('form-id:ui-outer:0:ui-inner:0:section')).click(function(){
                var id=event.target.id;
                console.log(id);
            });
            
//            $.ajax({
//                    url:'#sectionBean2.selectID',
//                    data:{event.target.id},
//                    method:'post',
//                    success:'#sectionBean2.selectSectionIndex()',
//                    contentType:'xml'
//                })
           
        </script>
    </h:body>
</html>

