<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Survey</title>
         <h:outputStylesheet library="css" name="styles.css"/>
        <script src="jquery-3.5.1.js" type="text/javascript"></script>
        <script type="text/javascript">
           function handleClick(ref){
               var a=(ref.id);
               var arr=a.split(":");
               console.log(parseInt(arr[2])+1);
               document.getElementById("form-id:hidden-section").value=parseInt(arr[2])+1;
               document.getElementById("form-id:clickedid").click();
           }           
        </script>
    </h:head>
    <h:body>
            <h:panelGroup layout="block" class="form-div" >
            <h:form class="classforform" id="form-id" prependId="true">
                
                <h:panelGroup class="button-group" rendered="true">
                <h1 class="header">Form Builder ðŸ“ƒ</h1> <br/>
                 <h:inputHidden id="hidden-section" value="#{sectionBean2.sectionIndex}"></h:inputHidden>
                 <h:commandLink id="clickedid" >
                     <f:ajax execute="hidden-section" />
                 </h:commandLink>
                <h:commandButton class="button" value="Add TEXT" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='TEXT' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add TEXTAREA" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='TEXTAREA' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add SECRET" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='SECRET' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add CHECKONE" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='CHECKONE' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add LABEL" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='LABEL' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                <h:commandButton class="button" value="Add COMBOBOX" action="#{sectionBean2.addItem()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='COMBOBOX' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                </h:panelGroup>
                <h:panelGroup class="outer-item" >
                <h:panelGroup class="item">    
                <h:outputText id="section" class="header-section" value="Form" rendered="true" />
                <ui:repeat value="#{sectionBean2.sections}" var="section" id="ui-outer">
                    <ui:repeat value="#{section}" var="item" id="ui-inner">
                        
                        <h:outputLabel id="section" class="added-section" value="#{item.name}" onclick="handleClick(this)" rendered="#{item.type == 'SECTION'}">
                        </h:outputLabel>
                        <h:inputText class="added-item" value="#{item.name}" rendered="#{item.type == 'TEXT'}" />
                        <h:inputSecret class="added-item" value="#{item.name}" rendered="#{item.type == 'SECRET'}" />
                        <h:inputTextarea class="added-item" value="#{item.name}" rendered="#{item.type == 'TEXTAREA'}" />
                        <h:selectBooleanCheckbox class="added-item" value="#{item.name}" rendered="#{item.type == 'CHECKONE'}" />
                        <h:outputLabel class="added-item" value="#{item.name}" for="text1" rendered="#{item.type == 'LABEL'}" />
                        <h:selectOneMenu class="added-item" value = "#{item.name}" rendered="#{item.type == 'COMBOBOX'}">
                            <f:selectItem itemValue = "1" itemLabel = "Item 1" />
                            <f:selectItem itemValue = "2" itemLabel = "Item 2" />
                        </h:selectOneMenu>
                    </ui:repeat>    
                </ui:repeat>
                </h:panelGroup>
                <h:panelGroup class="add-section">
                <h:inputTextarea value="#{sectionBean2.name}" id="section2" required="false"
                             requiredMessage="Please fill this field"/>
                <h:commandButton class="button" value="Add Section" action="#{sectionBean2.addSection()}">
                     <f:setPropertyActionListener target="#{sectionBean2.type}" value='SECTION' />
                     <f:setPropertyActionListener target="#{sectionBean2.key}" value="1" />
                     <f:setPropertyActionListener target="#{sectionBean2.value}" value="Section1" />
                </h:commandButton>
                </h:panelGroup>
                </h:panelGroup>
                
            </h:form>
        </h:panelGroup>
         
        <script type="text/javascript">
           
        </script>
    </h:body>
</html>

